<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Kiwi English Exams</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="Login Page" name="description">

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon">

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;600&display=swap"
    rel="stylesheet">

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

  <!-- Libraries Stylesheet -->
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/style.css" rel="stylesheet">
</head>

<body>
  <!-- Navbar Start -->
  <div class="container-fluid p-0">
    <nav class="navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0 px-lg-5 fixed-top">
      <a href="/" class="navbar-brand ml-lg-3">
        <h1 class="m-0 text-uppercase text-primary"><i class="fa fa-book-reader mr-3"></i>Kiwi English Exams
        </h1>
      </a>
      <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-between px-lg-3" id="navbarCollapse">
        <div class="navbar-nav mx-auto py-0">
          <a href="index.html" class="nav-item nav-link">Home</a>
          <a href="login.html" class="nav-item nav-link active">Login</a>
        </div>
        <a href="student-registration.html" class="btn btn-primary py-2 px-4 d-none d-lg-block">Register as Student</a>
      </div>
    </nav>
  </div>
  <!-- Navbar End -->

  <!-- Login Section Start -->
  <div class="container-fluid py-5 mt-5">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-12 col-md-6">
          <div class="bg-light p-5 rounded shadow-sm">
            <h3 class="text-center mb-4 text-primary">Login to Your Account</h3>
            <form id="loginForm">
              <div class="form-group">
                <label for="email">Email Address</label>
                <input type="email" class="form-control" id="email" name="email" placeholder="Enter your email"
                  required>
              </div>
              <div class="form-group mb-4">
                <label for="password">Password</label>
                <input type="password" class="form-control" id="password" name="password"
                  placeholder="Enter your password" required>
              </div>
              <button type="submit" class="btn btn-primary btn-block">Login</button>
              <div id="message" class="mt-3"></div>
              <div class="text-center mt-3">
                <!-- <p class="m-0">Don't have an account? <a href="student-registration.html"
                    class="text-primary">Register</a></p> -->
                <p class="m-0 mt-1"><a href="#" class="text-secondary">Forgot Password?</a></p>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  <!-- Login Section End -->

  <!-- Footer Start -->
  <div class="container-fluid position-relative overlay-top bg-dark text-white-50 py-5" style="margin-top: 90px;">
    <div class="container">
      <div class="row">
        <!-- Brand & Description -->
        <div class="col-md-12 mt-5">
          <a href="index.html" class="navbar-brand">
            <h1 class="mt-n2 text-uppercase text-white">
              <i class="fa fa-book-reader me-2"></i> Kiwi English Exams
            </h1>
          </a>
          <p class="m-0 text-justify mt-1">
            At Kiwi English Exams, we are your trusted partner in mastering English proficiency tests across
            New Zealand and beyond. Whether you're preparing for academic, professional, or immigration
            purposes, our expert guidance, proven strategies, and personalized support will help you achieve
            the results you need. Join thousands of successful learners who have reached their goals with
            confidence and clarity.
          </p>
        </div>
      </div>

      <div class="row">
        <!-- Contact Info -->
        <div class="col-md-8 mt-4">
          <h3 class="text-white">Get In Touch</h3>
          <p><i class="fa fa-map-marker-alt me-2"></i>123 Lambton Quay, Wellington Central, Wellington 6011,
            New Zealand</p>
          <p><i class="fa fa-phone-alt me-2"></i>+64 21 987 6543</p>
          <p><i class="fa fa-envelope me-2"></i>info@kiwienglishexams.nz</p>
        </div>

        <!-- Social Media -->
        <div class="col-md-4 mt-4 text-justify">
          <!-- First Row: Heading -->
          <div class="mb-3">
            <h3 class="text-white mb-0">Follow Us</h3>
          </div>

          <!-- Second Row: Icons -->
          <div class="d-flex flex-row justify-content-start">
            <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-twitter"></i></a>
            <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-facebook-f"></i></a>
            <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-linkedin-in"></i></a>
            <a class="text-white" href="#"><i class="fab fa-2x fa-instagram"></i></a>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="container-fluid bg-dark text-white-50 border-top py-4"
    style="border-color: rgba(256, 256, 256, .1) !important;">
    <div class="container">
      <div class="row">
        <div class="col-md-6 text-center text-md-left mb-3 mb-md-0">
          <p class="m-0">Copyright &copy; <a class="text-white" href="#">kiwiexams.netlify.app</a>. All Rights
            Reserved.
          </p>
        </div>
      </div>
    </div>
  </div>
  <!-- Footer End -->

  <!-- Back to Top -->
  <a href="#" class="btn btn-lg btn-primary rounded-0 btn-lg-square back-to-top"><i
      class="fa fa-angle-double-up"></i></a>

  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/waypoints/waypoints.min.js"></script>
  <script src="lib/counterup/counterup.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>

  <!-- Template Javascript -->
  <script src="js/main.js"></script>

  <!-- login form -->
  <script>
    const form = document.getElementById('loginForm');
    const messageDiv = document.getElementById('message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const email = document.getElementById('email').value.trim();
      const password = document.getElementById('password').value.trim();

      try {
        const response = await fetch('https://b-end-test.netlify.app/.netlify/functions/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password }),
        });

        const data = await response.json();

        if (response.ok) {
          localStorage.setItem('token', data.token); // Save token
          localStorage.setItem('userId', data.userId);
          localStorage.setItem('role', data.role);
          loginForm.reset();

          messageDiv.innerHTML = `<div class="alert alert-success">Login successful!</div>`;

          setTimeout(() => {
            switch (data.role) {
              case 'superadmin':
                window.location.href = '/superadmin-dashboard.html';
                break;
              case 'countrydirector':
                window.location.href = '/countrydirector-dashboard.html';
                break;
              case 'examiner':
                window.location.href = '/examiner-dashboard.html';
                break;
              case 'student':
                window.location.href = '/student-dashboard.html';
                break;
              default:
                messageDiv.innerHTML = `<div class="alert alert-danger">Unknown role</div>`;
            }
          }, 100);
        } else {
          messageDiv.innerHTML = `<div class="alert alert-danger">${data.error || 'Login failed'}</div>`;
        }

      } catch (err) {
        console.error(err);
        messageDiv.innerHTML = `<div class="alert alert-danger">Unexpected error occurred.</div>`;
      }
    });
  </script>
</body>

</html>