<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Kiwi English Exams</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <!-- Bootstrap (optional if already added) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />

    <!-- intl-tel-input CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css" />

    <!-- intl-tel-input JS and dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>


    <!-- Bootstrap CSS (if not already included) -->
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"> -->

    <!-- Country Select CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/country-select-js@2.0.1/build/css/countrySelect.min.css">

    <!-- jQuery (required for country-select) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Country Select JS -->
    <script src="https://cdn.jsdelivr.net/npm/country-select-js@2.0.1/build/js/countrySelect.min.js"></script>


    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap 5 JS and Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Favicon -->
    <link href="img/favicon.ico" rel="icon">

    <!-- Google Web Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;600&display=swap"
        rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">

    <!-- Libraries Stylesheet -->
    <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="css/style.css" rel="stylesheet">
</head>

<body>

    <script>
        const token = localStorage.getItem('token');
        const role = localStorage.getItem('role');

        if (!token || role !== 'examiner') {
            window.location.href = '/login.html'; // redirect to login or 403 page
        }
    </script>

    <!-- Navbar Start -->
    <div class="container-fluid p-0">
        <nav class="navbar navbar-expand-lg bg-white navbar-light py-3 py-lg-0 px-lg-5 fixed-top">
            <a href="/" class="navbar-brand ml-lg-3">
                <h1 class="m-0 text-uppercase text-primary"><i class="fa fa-book-reader mr-3"></i>Kiwi English Exams
                </h1>
            </a>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-between px-lg-3" id="navbarCollapse">
                <div class="navbar-nav mx-auto py-0">

                    <!-- <a href="examiner-dashboard.html" class="nav-item nav-link">Examiner Dashboard</a> -->
                    <a href="exams-list.html" class="nav-item nav-link active">Exam Details</a>
                    <a href="examiner-profile.html" class="nav-item nav-link">Profile</a>
                </div>
                <a href="#" onclick="logout()" class="btn btn-primary py-2 px-4 d-none d-lg-block">Logout</a>
            </div>
        </nav>
    </div>
    <!-- Navbar End -->

    <!-- Admin Dashboard Start -->
    <div class="container">
        <section class="mt-5" id="users">
            <h2 class="mb-4 text-primary"><i class="fa fa-file-alt mr-2"></i>Exam Details</h2>

            <!-- Edit Subject Form -->
            <div class="card mb-4 shadow-sm">
                <div class="card-header bg-primary">
                    <h5 class="text-white mb-0">Edit Exams</h5>
                </div>
                <div class="card-body">
                    <form id="examForm">
                        <input type="hidden" id="exam_id" required>
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="subject_name" class="form-label">Exam Name</label>
                            </div>
                            <div class="col-md-9">
                                <input type="text" class="form-control" id="exam_name" placeholder="Enter Exam Name"
                                    required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="subject_name" class="form-label">Exam Fee</label>
                            </div>
                            <div class="col-md-9">
                                <input type="number" class="form-control" id="exam_fee" placeholder="Enter Exam Fee"
                                    required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="subject_name" class="form-label">Exam Date</label>
                            </div>
                            <div class="col-md-9">
                                <input type="date" class="form-control" id="exam_date"
                                    required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="subject_name" class="form-label">Start Time</label>
                            </div>
                            <div class="col-md-9">
                                <input type="time" class="form-control" id="exam_start_time" placeholder="Enter Subject"
                                    required>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-3">
                                <label for="subject_name" class="form-label">End Time</label>
                            </div>
                            <div class="col-md-9">
                                <input type="time" class="form-control" id="exam_end_time" placeholder="Enter Subject"
                                    required>
                            </div>
                        </div>
                        <div class="text-end">
                            <a href="exams-list.html" class="btn btn-success">Exams List</a>
                            <button type="submit" class="btn btn-primary">Edit Exam</button>
                        </div>

                        <div id="add-message" class="mt-2 text-center"></div>
                    </form>
                </div>
            </div>
        </section>
    </div>
    <!-- Admin Dashboard End -->

    <!-- Footer Start -->
    <div class="container-fluid position-relative overlay-top bg-dark text-white-50 py-5" style="margin-top: 90px;">
        <div class="container">
          <div class="row">
            <!-- Brand & Description -->
            <div class="col-md-12 mt-5">
              <a href="index.html" class="navbar-brand">
                <h1 class="mt-n2 text-uppercase text-white">
                  <i class="fa fa-book-reader me-2"></i> Kiwi English Exams
                </h1>
              </a>
              <p class="m-0 text-justify mt-1">
                At Kiwi English Exams, we are your trusted partner in mastering English proficiency tests across
                New Zealand and beyond. Whether you're preparing for academic, professional, or immigration
                purposes, our expert guidance, proven strategies, and personalized support will help you achieve
                the results you need. Join thousands of successful learners who have reached their goals with
                confidence and clarity.
              </p>
            </div>
          </div>
    
          <div class="row">
            <!-- Contact Info -->
            <div class="col-md-8 mt-4">
              <h3 class="text-white">Get In Touch</h3>
              <p><i class="fa fa-map-marker-alt me-2"></i>123 Lambton Quay, Wellington Central, Wellington 6011,
                New Zealand</p>
              <p><i class="fa fa-phone-alt me-2"></i>+64 21 987 6543</p>
              <p><i class="fa fa-envelope me-2"></i>info@kiwienglishexams.nz</p>
            </div>
    
            <!-- Social Media -->
            <div class="col-md-4 mt-4 text-justify">
              <!-- First Row: Heading -->
              <div class="mb-3">
                <h3 class="text-white mb-0">Follow Us</h3>
              </div>
    
              <!-- Second Row: Icons -->
              <div class="d-flex flex-row justify-content-start">
                <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-twitter"></i></a>
                <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-facebook-f"></i></a>
                <a class="text-white mr-4" href="#"><i class="fab fa-2x fa-linkedin-in"></i></a>
                <a class="text-white" href="#"><i class="fab fa-2x fa-instagram"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>
    
      <div class="container-fluid bg-dark text-white-50 border-top py-4"
        style="border-color: rgba(256, 256, 256, .1) !important;">
        <div class="container">
          <div class="row">
            <div class="col-md-6 text-center text-md-left mb-3 mb-md-0">
              <p class="m-0">Copyright &copy; <a class="text-white" href="#">kiwiexams.netlify.app</a>. All Rights
                Reserved.
              </p>
            </div>
          </div>
        </div>
      </div>
    <!-- Footer End -->

    <!-- Back to Top -->
    <a href="#" class="btn btn-lg btn-primary rounded-0 btn-lg-square back-to-top"><i
            class="fa fa-angle-double-up"></i></a>

    <script>
        function logout() {
            localStorage.removeItem('token');
            localStorage.removeItem('userId');
            localStorage.removeItem('role');
            window.location.href = '/login.html'; // change this path if needed
        }
    </script>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');

        document.getElementById('exam_id').value = id;
        

        fetch(`https://b-end-test.netlify.app/.netlify/functions/get-exam-by-id?id=${id}`)
            .then(res => res.json())
            .then(data => {
                document.querySelector('#exam_name').value = data.exam_name;
                document.querySelector('#exam_fee').value = data.exam_fee;
                document.querySelector('#exam_date').value = data.exam_date.split('T')[0];
                document.querySelector('#exam_start_time').value = data.exam_start_time;
                document.querySelector('#exam_end_time').value = data.exam_end_time;
            })
            .catch(error => console.error('Error loading exam:', error));
    </script>

    <script>
        document.getElementById('examForm').addEventListener('submit', function (e) {
            e.preventDefault();

            fetch(`https://b-end-test.netlify.app/.netlify/functions/edit-exam`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    id: document.getElementById('exam_id').value,
                    exam_name: document.getElementById('exam_name').value,
                    exam_fee: document.getElementById('exam_fee').value,
                    exam_date: document.getElementById('exam_date').value,
                    exam_start_time: document.getElementById('exam_start_time').value,
                    exam_end_time: document.getElementById('exam_end_time').value,
                }),
            })
                .then(res => res.json())
                .then(data => {
                    if (data.message || data._id) {
                        window.location.href = 'exams-list.html';
                    } else {
                        alert('Update failed: ' + (data.error || 'Unknown error'));
                    }
                })
                .catch(err => {
                    console.error('❌ Update error:', err);
                    alert('Network error while updating.');
                });
        });

    </script>

    <!-- JavaScript Libraries -->

    <!-- <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script> -->
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
    <script src="lib/easing/easing.min.js"></script>
    <script src="lib/waypoints/waypoints.min.js"></script>
    <script src="lib/counterup/counterup.min.js"></script>
    <script src="lib/owlcarousel/owl.carousel.min.js"></script>

    <!-- Template Javascript -->
    <script src="js/main.js"></script>



</body>

</html>